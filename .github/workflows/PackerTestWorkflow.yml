name: Tester for Packer
run-name: initalize packer and applying infra
env: 
  PKR_VAR_access_key: ${{secrets.PKR_VAR_access_key}} #required for validation
  PKR_VAR_secret_key: ${{secrets.PKR_VAR_secret_key}} #required for validation
on: 
    pull_request :
      types: 
        - opened 
        - reopened
      branches: 
        - main
jobs:
    intialize-packer-and-deploy:
        runs-on: ubuntu-latest
        steps:
         - uses: actions/checkout@v4
         - uses: hashicorp/setup-packer@main
           with:
            version: 1.10.1

         - name: packer format check 
           run: packer fmt -check packer.pkr.hcl

         - name: packer downloading the binaries for the required provided 
           run:  packer init packer.pkr.hcl 

         - name: Status check to validate packer validate 
           run: packer validate  packer.pkr.hcl
        